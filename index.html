<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üì± ÿ®ÿ±ÿßŸÜÿØ ŸÅŸàŸÜ</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --primary: #0077ff;
      --primary-dark: #0056b3;
      --secondary: #6c757d;
      --success: #28a745;
      --danger: #dc3545;
      --warning: #ffc107;
      --info: #17a2b8;
      --light: #f8f9fa;
      --dark: #343a40;
      --gray: #6c757d;
      --border-radius: 12px;
      --box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      --transition: all 0.3s ease;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: "Tajawal", sans-serif;
      display: flex;
      min-height: 100vh;
      background: #f4f6f9;
      color: #333;
    }

    aside {
      background: linear-gradient(180deg, var(--primary) 0%, var(--primary-dark) 100%);
      color: #fff;
      width: 250px;
      min-height: 100vh;
      padding: 20px 10px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      box-shadow: var(--box-shadow);
      z-index: 100;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 15px;
      margin-bottom: 20px;
      border-bottom: 1px solid rgba(255,255,255,0.2);
    }

    .logo h2 {
      font-size: 20px;
      font-weight: 700;
    }

    .logo i {
      font-size: 24px;
    }

    .nav-item {
      background: transparent;
      border: none;
      color: #fff;
      font-size: 16px;
      padding: 12px 15px;
      text-align: right;
      cursor: pointer;
      border-radius: 8px;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .nav-item:hover, .nav-item.active {
      background: rgba(255,255,255,0.15);
    }

    .nav-item i {
      width: 20px;
      text-align: center;
    }

    main {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
    }

    section {
      display: none;
      animation: fadeIn 0.5s;
    }

    section.active {
      display: block;
    }

    .page-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 1px solid #e0e0e0;
    }

    .page-header h1 {
      color: var(--primary);
      font-size: 24px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .card {
      background: #fff;
      padding: 20px;
      border-radius: var(--border-radius);
      box-shadow: var(--box-shadow);
      margin-bottom: 20px;
      transition: var(--transition);
    }

    .card:hover {
      box-shadow: 0 6px 16px rgba(0,0,0,0.12);
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 1px solid #eee;
    }

    .card-title {
      font-size: 18px;
      font-weight: 700;
      color: var(--primary);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    input, select, textarea {
      width: 100%;
      padding: 12px;
      margin: 8px 0;
      border-radius: 8px;
      border: 1px solid #ddd;
      font-family: "Tajawal", sans-serif;
      transition: var(--transition);
    }

    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 2px rgba(0,119,255,0.2);
    }

    .btn {
      padding: 12px 20px;
      border-radius: 8px;
      border: none;
      font-family: "Tajawal", sans-serif;
      font-weight: 500;
      cursor: pointer;
      transition: var(--transition);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .btn-primary {
      background: var(--primary);
      color: white;
    }

    .btn-primary:hover {
      background: var(--primary-dark);
    }

    .btn-success {
      background: var(--success);
      color: white;
    }

    .btn-danger {
      background: var(--danger);
      color: white;
    }

    .btn-warning {
      background: var(--warning);
      color: #212529;
    }

    .btn-sm {
      padding: 8px 12px;
      font-size: 14px;
    }

    .sale-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 0;
      border-bottom: 1px solid #eee;
    }

    .invoice-total {
      background: #f8f9fa;
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
      font-weight: 700;
      font-size: 18px;
      text-align: center;
    }

    .search-container {
      position: relative;
      margin-bottom: 15px;
    }

    .search-container i {
      position: absolute;
      left: 15px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--gray);
    }

    .search-container input {
      padding-left: 40px;
    }

    .alert {
      padding: 12px 15px;
      border-radius: 8px;
      margin: 10px 0;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .alert-success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .alert-danger {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }

    .alert-warning {
      background: #fff3cd;
      color: #856404;
      border: 1px solid #ffeaa7;
    }

    .alert-info {
      background: #d1ecf1;
      color: #0c5460;
      border: 1px solid #bee5eb;
    }

    .form-row {
      display: flex;
      gap: 10px;
      margin-bottom: 10px;
    }

    .form-group {
      flex: 1;
    }

    /* ÿ¨ÿØŸàŸÑ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ */
    .table-container {
      overflow-x: auto;
      margin-top: 15px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin: 15px 0;
    }

    th, td {
      padding: 12px 15px;
      text-align: right;
      border-bottom: 1px solid #eee;
    }

    th {
      background-color: #f8f9fa;
      font-weight: 600;
      color: var(--primary);
    }

    tr:hover {
      background-color: #f8f9fa;
    }

    .low-stock {
      color: var(--danger);
      font-weight: bold;
    }

    /* ŸÜÿ™ÿßÿ¶ÿ¨ ÿßŸÑÿ®ÿ≠ÿ´ ŸÅŸä ÿßŸÑÿ®Ÿäÿπ */
    .search-results {
      max-height: 200px;
      overflow-y: auto;
      border: 1px solid #eee;
      border-radius: 8px;
      margin-top: 10px;
      display: none;
    }

    .search-result-item {
      padding: 10px 15px;
      border-bottom: 1px solid #eee;
      cursor: pointer;
      transition: var(--transition);
    }

    .search-result-item:hover {
      background-color: #f0f8ff;
    }

    .search-result-item:last-child {
      border-bottom: none;
    }


    .invoice-box {
  background: #fff;
  border: 1px solid #eee;
  border-radius: 10px;
  padding: 15px;
  margin-bottom: 20px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.05);
}

.invoice-box h3 {
  margin: 0 0 8px;
  color: #222;
}

.invoice-box small {
  color: #666;
  display: block;
  margin-bottom: 10px;
}

.items-table {
  width: 100%;
  border-collapse: collapse;
  margin-bottom: 10px;
}

.items-table th, .items-table td {
  border: 1px solid #ddd;
  padding: 8px;
  text-align: center;
  font-size: 14px;
}

.items-table th {
  background: #f5f5f5;
  font-weight: bold;
}

.total {
  text-align: right;
  font-size: 15px;
  font-weight: bold;
  margin-top: 5px;
}

.invoice-total {
  background: #fafafa;
  border: 1px solid #eee;
  border-radius: 8px;
  padding: 12px;
  margin-top: 20px;
}


    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @media (max-width: 768px) {
      body {
        flex-direction: column;
      }
      
      aside {
        width: 100%;
        min-height: auto;
        padding: 10px;
      }
      
      .nav-container {
        display: flex;
        overflow-x: auto;
        gap: 5px;
      }
      
      .nav-item {
        white-space: nowrap;
        flex-shrink: 0;
      }
      
      .form-row {
        flex-direction: column;
      }
      
      .page-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
      }
      
      .table-container {
        font-size: 14px;
      }
      
      th, td {
        padding: 8px 10px;
      }
    }

    @media (max-width: 480px) {
      .card {
        padding: 15px;
      }
      
      .btn {
        padding: 10px 15px;
        font-size: 14px;
      }
      
      table {
        font-size: 12px;
      }
      
      th, td {
        padding: 6px 8px;
      }
    }
  </style>
</head>
<body>
  <!-- ÿßŸÑŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ¨ÿßŸÜÿ®Ÿäÿ© -->
  <aside>
    <div class="logo">
      <i class="fas fa-mobile-alt"></i>
      <h2>ÿ®ÿ±ÿßŸÜÿØ ŸÅŸàŸÜ</h2>
    </div>
    
    <div class="nav-container">
      <button class="nav-item active" onclick="showTab('products')">
        <i class="fas fa-boxes"></i>
        <span>ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™</span>
      </button>
      <button class="nav-item" onclick="showTab('sale')">
        <i class="fas fa-cash-register"></i>
        <span>ŸÜŸÇÿ∑ÿ© ÿßŸÑÿ®Ÿäÿπ</span>
      </button>
      <button class="nav-item" onclick="showTab('reports')">
        <i class="fas fa-chart-bar"></i>
        <span>ÿßŸÑÿ™ŸÇÿßÿ±Ÿäÿ±</span>
      </button>
    </div>
  </aside>

  <!-- ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä -->
  <main>
    <!-- ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ -->
    <section id="products" class="active">
      <div class="page-header">
        <h1><i class="fas fa-boxes"></i> ÿ•ÿØÿßÿ±ÿ© ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™</h1>
        <button class="btn btn-primary" onclick="showProductModal()">
          <i class="fas fa-plus"></i> ÿ•ÿ∂ÿßŸÅÿ© ŸÖŸÜÿ™ÿ¨
        </button>
      </div>
      
      <div class="card">
        <div class="card-header">
          <h3 class="card-title"><i class="fas fa-search"></i> ÿ®ÿ≠ÿ´ ÿπŸÜ ŸÖŸÜÿ™ÿ¨</h3>
        </div>
        <div class="search-container">
          <i class="fas fa-search"></i>
          <input type="text" id="searchBox" placeholder="ÿßŸÉÿ™ÿ® ÿßÿ≥ŸÖ ÿßŸÑŸÖŸÜÿ™ÿ¨ ÿ£Ÿà ÿßŸÑÿ®ÿßÿ±ŸÉŸàÿØ..." oninput="searchProducts()">
        </div>
      </div>
      
      <div class="card">
        <div class="table-container">
          <table id="productsTable">
            <thead>
              <tr>
                <th>ÿßŸÑÿ®ÿßÿ±ŸÉŸàÿØ</th>
                <th>ÿßÿ≥ŸÖ ÿßŸÑŸÖŸÜÿ™ÿ¨</th>
                <th>ÿ≥ÿπÿ± ÿßŸÑÿ¥ÿ±ÿßÿ°</th>
                <th>ÿ≥ÿπÿ± ÿßŸÑÿ®Ÿäÿπ</th>
                <th>ÿßŸÑŸÉŸÖŸäÿ©</th>
                <th>ÿßŸÑÿ±ÿ®ÿ≠</th>
                <th>ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°ÿßÿ™</th>
              </tr>
            </thead>
            <tbody id="productsList">
              <!-- ÿ≥Ÿäÿ™ŸÖ ŸÖŸÑÿ§Ÿáÿß ÿ®ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ -->
            </tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- ŸÜŸÇÿ∑ÿ© ÿßŸÑÿ®Ÿäÿπ -->
    <section id="sale">
      <div class="page-header">
        <h1><i class="fas fa-cash-register"></i> ŸÜŸÇÿ∑ÿ© ÿßŸÑÿ®Ÿäÿπ</h1>
        <button class="btn btn-primary" onclick="printInvoice()">
          <i class="fas fa-print"></i> ÿ∑ÿ®ÿßÿπÿ© ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©
        </button>
      </div>
      
      <div class="card">
        <div class="card-header">
          <h3 class="card-title"><i class="fas fa-search"></i> ÿßŸÑÿ®ÿ≠ÿ´ ÿπŸÜ ŸÖŸÜÿ™ÿ¨</h3>
        </div>
        <div class="search-container">
          <i class="fas fa-search"></i>
          <input type="text" id="saleSearch" placeholder="ÿßÿ®ÿ≠ÿ´ ÿ®ÿßŸÑÿßÿ≥ŸÖ ÿ£Ÿà ÿßŸÑÿ®ÿßÿ±ŸÉŸàÿØ..." oninput="findProductForSale()">
        </div>
        <div id="searchResults" class="search-results"></div>
        <div id="saleProductInfo" class="alert alert-info" style="display:none;"></div>
        <div class="form-row">
          <div class="form-group">
            <input type="number" id="saleQty" placeholder="ÿßŸÑŸÉŸÖŸäÿ©" min="1" value="1">
          </div>
          <div>
            <button class="btn btn-success" onclick="addToInvoice()">
              <i class="fas fa-plus"></i> ÿ•ÿ∂ÿßŸÅÿ© ŸÑŸÑŸÅÿßÿ™Ÿàÿ±ÿ©
            </button>
          </div>
        </div>
      </div>
      
      <div class="card">
        <div class="card-header">
          <h3 class="card-title"><i class="fas fa-receipt"></i> ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©</h3>
          <button class="btn btn-danger btn-sm" onclick="clearInvoice()">
            <i class="fas fa-trash"></i> ŸÖÿ≥ÿ≠ ÿßŸÑŸÉŸÑ
          </button>
        </div>
        <div id="invoiceList"></div>
        <div class="invoice-total" id="invoiceTotal">ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä: 0 ÿ¨</div>
        <div style="display: flex; gap: 10px; margin-top: 15px;">
          <button class="btn btn-primary" onclick="completeSale()" style="flex: 1;">
            <i class="fas fa-check"></i> ÿ•ÿ™ŸÖÿßŸÖ ÿßŸÑÿ®Ÿäÿπ
          </button>
        </div>
      </div>
    </section>

    <!-- ÿßŸÑÿ™ŸÇÿßÿ±Ÿäÿ± -->
    <section id="reports">
      <div class="page-header">
        <h1><i class="fas fa-chart-bar"></i> ÿßŸÑÿ™ŸÇÿßÿ±Ÿäÿ± ŸàÿßŸÑÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™</h1>
        <div>
          <button class="btn btn-primary" onclick="exportReport()">
            <i class="fas fa-download"></i> ÿ™ÿµÿØŸäÿ± ÿßŸÑÿ™ŸÇÿ±Ÿäÿ±
          </button>
        </div>
      </div>
      
      <div class="card">
        <div class="card-header">
          <h3 class="card-title"><i class="fas fa-shopping-cart"></i> ÿ™ŸÇÿ±Ÿäÿ± ÿßŸÑŸÖÿ®Ÿäÿπÿßÿ™</h3>
          <div>
            <input type="date" id="reportStartDate">
            <span> ÿ•ŸÑŸâ </span>
            <input type="date" id="reportEndDate">
            <button class="btn btn-primary btn-sm" onclick="getSalesReport()">ÿπÿ±ÿ∂</button>
            <button class="btn btn-success btn-sm" onclick="getTodayReport()">ÿ™ŸÇÿ±Ÿäÿ± ÿßŸÑŸäŸàŸÖ</button>
          </div>
        </div>
        <div id="salesReport"></div>
      </div>
      
      <div class="card">
        <div class="card-header">
          <h3 class="card-title"><i class="fas fa-boxes"></i> ÿ™ŸÇÿ±Ÿäÿ± ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ</h3>
        </div>
        <div id="inventoryReport"></div>
      </div>
    </section>
  </main>

  <!-- Firebase & JS -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
    import { getFirestore, collection, addDoc, getDocs, updateDoc, deleteDoc, doc, query, orderBy, where, getDoc } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAV5PxtRBw7aamAmSycxI_NdzR7YVgmmSw",
      authDomain: "kasher-os.firebaseapp.com",
      projectId: "kasher-os",
      storageBucket: "kasher-os.firebasestorage.app",
      messagingSenderId: "956040501711",
      appId: "1:956040501711:web:e8eecede32465923e2daba",
      measurementId: "G-XFRPMZVFL7"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    let allProducts = [], selectedProduct = null, invoice = [], total = 0;

    // ÿ™ŸáŸäÿ¶ÿ© ÿßŸÑÿµŸÅÿ≠ÿ©
    document.addEventListener('DOMContentLoaded', function() {
      loadProducts();
      
      // ÿ™ÿπŸäŸäŸÜ ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑŸäŸàŸÖ ŸÅŸä ÿßŸÑÿ™ŸÇÿßÿ±Ÿäÿ±
      const today = new Date().toISOString().split('T')[0];
      document.getElementById('reportStartDate').value = today;
      document.getElementById('reportEndDate').value = today;
    });

    // ÿ™ŸÜŸÇŸÑ ÿ®ŸäŸÜ ÿßŸÑÿµŸÅÿ≠ÿßÿ™
    window.showTab = (id) => {
      document.querySelectorAll(".nav-item").forEach(b => b.classList.remove("active"));
      document.querySelectorAll("main section").forEach(s => s.classList.remove("active"));
      document.querySelector(`.nav-item[onclick="showTab('${id}')"]`).classList.add("active");
      document.getElementById(id).classList.add("active");
      
      // ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ™ŸÇÿßÿ±Ÿäÿ± ÿπŸÜÿØ ŸÅÿ™ÿ≠ ŸÇÿ≥ŸÖ ÿßŸÑÿ™ŸÇÿßÿ±Ÿäÿ±
      if (id === 'reports') {
        setTimeout(() => {
          getInventoryReport();
          getTodayReport();
        }, 100);
      }
    }

    // ÿ•ÿ∂ÿßŸÅÿ© ŸÖŸÜÿ™ÿ¨ ÿ¨ÿØŸäÿØ
    window.showProductModal = () => {
      const name = prompt("ÿßÿ≥ŸÖ ÿßŸÑŸÖŸÜÿ™ÿ¨:");
      if (!name) return;
      
      const barcode = prompt("ÿ®ÿßÿ±ŸÉŸàÿØ ÿßŸÑŸÖŸÜÿ™ÿ¨:");
      if (!barcode) return;
      
      const costPrice = parseFloat(prompt("ÿ≥ÿπÿ± ÿßŸÑÿ¥ÿ±ÿßÿ°:"));
      if (!costPrice || costPrice <= 0) {
        alert("‚ö†Ô∏è ÿßÿØÿÆŸÑ ÿ≥ÿπÿ± ÿ¥ÿ±ÿßÿ° ÿµÿ≠Ÿäÿ≠");
        return;
      }
      
      const sellPrice = parseFloat(prompt("ÿ≥ÿπÿ± ÿßŸÑÿ®Ÿäÿπ:"));
      if (!sellPrice || sellPrice <= 0) {
        alert("‚ö†Ô∏è ÿßÿØÿÆŸÑ ÿ≥ÿπÿ± ÿ®Ÿäÿπ ÿµÿ≠Ÿäÿ≠");
        return;
      }
      
      const qty = parseInt(prompt("ÿßŸÑŸÉŸÖŸäÿ©:") || 0);
      const category = prompt("ÿßŸÑŸÅÿ¶ÿ© (ÿßÿÆÿ™Ÿäÿßÿ±Ÿä):") || "ŸáŸàÿßÿ™ŸÅ";
      const description = prompt("ÿßŸÑŸàÿµŸÅ (ÿßÿÆÿ™Ÿäÿßÿ±Ÿä):") || "";
      
      addProductToDB(name, barcode, costPrice, sellPrice, qty, category, description);
    }

    async function addProductToDB(name, barcode, costPrice, sellPrice, qty, category, description) {
      try {
        await addDoc(collection(db, "products"), {
          name, 
          barcode, 
          costPrice, 
          sellPrice, 
          qty, 
          category, 
          description,
          createdAt: new Date(),
          lowStockAlert: qty <= 5
        });
        showAlert("‚úÖ ÿ™ŸÖ ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑŸÖŸÜÿ™ÿ¨ ÿ®ŸÜÿ¨ÿßÿ≠", "success");
        loadProducts();
      } catch (error) {
        console.error("Error adding product: ", error);
        showAlert("‚ùå ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑŸÖŸÜÿ™ÿ¨", "danger");
      }
    }

    // ÿ™ÿπÿØŸäŸÑ ŸÖŸÜÿ™ÿ¨
    window.editProduct = async (id, name, barcode, costPrice, sellPrice, qty, category, description) => {
      const newName = prompt("ÿ™ÿπÿØŸäŸÑ ÿßŸÑÿßÿ≥ŸÖ:", name);
      if (!newName) return;
      
      const newBarcode = prompt("ÿ™ÿπÿØŸäŸÑ ÿßŸÑÿ®ÿßÿ±ŸÉŸàÿØ:", barcode);
      if (!newBarcode) return;
      
      const newCostPrice = parseFloat(prompt("ÿ™ÿπÿØŸäŸÑ ÿ≥ÿπÿ± ÿßŸÑÿ¥ÿ±ÿßÿ°:", costPrice));
      if (!newCostPrice || newCostPrice <= 0) {
        alert("‚ö†Ô∏è ÿßÿØÿÆŸÑ ÿ≥ÿπÿ± ÿ¥ÿ±ÿßÿ° ÿµÿ≠Ÿäÿ≠");
        return;
      }
      
      const newSellPrice = parseFloat(prompt("ÿ™ÿπÿØŸäŸÑ ÿ≥ÿπÿ± ÿßŸÑÿ®Ÿäÿπ:", sellPrice));
      if (!newSellPrice || newSellPrice <= 0) {
        alert("‚ö†Ô∏è ÿßÿØÿÆŸÑ ÿ≥ÿπÿ± ÿ®Ÿäÿπ ÿµÿ≠Ÿäÿ≠");
        return;
      }
      
      const newQty = parseInt(prompt("ÿ™ÿπÿØŸäŸÑ ÿßŸÑŸÉŸÖŸäÿ©:", qty) || 0);
      const newCategory = prompt("ÿ™ÿπÿØŸäŸÑ ÿßŸÑŸÅÿ¶ÿ©:", category) || "ŸáŸàÿßÿ™ŸÅ";
      const newDescription = prompt("ÿ™ÿπÿØŸäŸÑ ÿßŸÑŸàÿµŸÅ:", description) || "";
      
      try {
        await updateDoc(doc(db, "products", id), {
          name: newName,
          barcode: newBarcode,
          costPrice: newCostPrice,
          sellPrice: newSellPrice,
          qty: newQty,
          category: newCategory,
          description: newDescription,
          lowStockAlert: newQty <= 5
        });
        showAlert("‚úÖ ÿ™ŸÖ ÿ™ÿπÿØŸäŸÑ ÿßŸÑŸÖŸÜÿ™ÿ¨ ÿ®ŸÜÿ¨ÿßÿ≠", "success");
        loadProducts();
      } catch (error) {
        console.error("Error updating product: ", error);
        showAlert("‚ùå ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿ™ÿπÿØŸäŸÑ ÿßŸÑŸÖŸÜÿ™ÿ¨", "danger");
      }
    }

    // ÿ≠ÿ∞ŸÅ ŸÖŸÜÿ™ÿ¨
    window.deleteProduct = async (id) => {
      if (confirm("ŸáŸÑ ÿ£ŸÜÿ™ ŸÖÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿ≠ÿ∞ŸÅ Ÿáÿ∞ÿß ÿßŸÑŸÖŸÜÿ™ÿ¨ÿü")) {
        try {
          await deleteDoc(doc(db, "products", id));
          showAlert("‚úÖ ÿ™ŸÖ ÿ≠ÿ∞ŸÅ ÿßŸÑŸÖŸÜÿ™ÿ¨ ÿ®ŸÜÿ¨ÿßÿ≠", "success");
          loadProducts();
        } catch (error) {
          console.error("Error deleting product: ", error);
          showAlert("‚ùå ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿ≠ÿ∞ŸÅ ÿßŸÑŸÖŸÜÿ™ÿ¨", "danger");
        }
      }
    }

    // ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™
    async function loadProducts() {
      allProducts = [];
      try {
        const snapshot = await getDocs(query(collection(db, "products"), orderBy("createdAt", "desc")));
        snapshot.forEach(docu => {
          allProducts.push({ id: docu.id, ...docu.data() });
        });
        renderProducts(allProducts);
      } catch (error) {
        console.error("Error loading products: ", error);
      }
    }

    function renderProducts(products) {
      const list = document.getElementById("productsList");
      list.innerHTML = "";
      
      if (products.length === 0) {
        list.innerHTML = `<tr><td colspan="7" style="text-align: center; padding: 20px;">
          <div class="alert alert-info"><i class="fas fa-info-circle"></i> ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÖŸÜÿ™ÿ¨ÿßÿ™</div>
        </td></tr>`;
        return;
      }
      
      products.forEach(p => {
        const profit = p.sellPrice - p.costPrice;
        const profitMargin = ((profit / p.costPrice) * 100).toFixed(1);
        const lowStockClass = p.qty <= 5 ? 'class="low-stock"' : '';
        
        list.innerHTML += `
          <tr>
            <td>${p.barcode}</td>
            <td>${p.name}</td>
            <td>${p.costPrice} ÿ¨</td>
            <td>${p.sellPrice} ÿ¨</td>
            <td ${lowStockClass}>${p.qty}</td>
            <td>${profit} ÿ¨ (${profitMargin}%)</td>
            <td>
              <button class="btn btn-warning btn-sm" onclick="editProduct('${p.id}', '${p.name}', '${p.barcode}', ${p.costPrice}, ${p.sellPrice}, ${p.qty}, '${p.category}', '${p.description || ''}')">
                <i class="fas fa-edit"></i>
              </button>
              <button class="btn btn-danger btn-sm" onclick="deleteProduct('${p.id}')">
                <i class="fas fa-trash"></i>
              </button>
            </td>
          </tr>`;
      });
    }

    // ÿßŸÑÿ®ÿ≠ÿ´ ŸÅŸä ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™
    window.searchProducts = () => {
      const q = document.getElementById("searchBox").value.toLowerCase();
      const filtered = allProducts.filter(p => 
        p.name.toLowerCase().includes(q) || 
        p.barcode.includes(q) ||
        p.category.toLowerCase().includes(q)
      );
      renderProducts(filtered);
    }

    // ÿßŸÑÿ®ÿ≠ÿ´ ŸÅŸä ÿßŸÑÿ®Ÿäÿπ
    window.findProductForSale = () => {
      const q = document.getElementById("saleSearch").value.toLowerCase();
      const resultsContainer = document.getElementById("searchResults");
      
      if (q.length < 1) {
        resultsContainer.style.display = "none";
        return;
      }
      
      const filtered = allProducts.filter(p => 
        p.name.toLowerCase().includes(q) || 
        p.barcode.includes(q)
      );
      
      if (filtered.length === 0) {
        resultsContainer.innerHTML = '<div class="search-result-item">ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÜÿ™ÿßÿ¶ÿ¨</div>';
        resultsContainer.style.display = "block";
        return;
      }
      
      resultsContainer.innerHTML = "";
      filtered.forEach(product => {
        const item = document.createElement("div");
        item.className = "search-result-item";
        item.innerHTML = `
          <div><strong>${product.name}</strong></div>
          <div>ÿ®ÿßÿ±ŸÉŸàÿØ: ${product.barcode} | ÿßŸÑÿ≥ÿπÿ±: ${product.sellPrice} ÿ¨ | ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ: ${product.qty}</div>
        `;
        item.addEventListener("click", () => {
          selectProductForSale(product);
        });
        resultsContainer.appendChild(item);
      });
      
      resultsContainer.style.display = "block";
    }

    function selectProductForSale(product) {
      selectedProduct = product;
      document.getElementById("saleSearch").value = product.name;
      document.getElementById("searchResults").style.display = "none";
      
      const info = document.getElementById("saleProductInfo");
      info.innerHTML = `<i class="fas fa-check-circle"></i> ÿßŸÑŸÖŸÜÿ™ÿ¨: ${selectedProduct.name} | ÿßŸÑÿ≥ÿπÿ±: ${selectedProduct.sellPrice}ÿ¨ | ŸÖÿ™ÿßÿ≠: ${selectedProduct.qty}`;
      info.className = "alert alert-success";
      info.style.display = "block";
      document.getElementById("saleQty").focus();
    }

    // ÿ•ÿ∂ÿßŸÅÿ© ŸÑŸÑŸÅÿßÿ™Ÿàÿ±ÿ©
    window.addToInvoice = async () => {
      if (!selectedProduct) {
        showAlert("‚ö†Ô∏è ÿßÿÆÿ™ÿ± ŸÖŸÜÿ™ÿ¨ ÿ£ŸàŸÑÿßŸã", "warning");
        return;
      }
      
      const qty = parseInt(document.getElementById("saleQty").value);
      if (!qty || qty <= 0) {
        showAlert("‚ö†Ô∏è ÿßÿØÿÆŸÑ ŸÉŸÖŸäÿ© ÿµÿ≠Ÿäÿ≠ÿ©", "warning");
        return;
      }
      
      if (selectedProduct.qty < qty) {
        showAlert(`‚ö†Ô∏è ÿßŸÑŸÉŸÖŸäÿ© ÿ∫Ÿäÿ± ŸÉÿßŸÅŸäÿ©. ÿßŸÑŸÖÿ™ÿßÿ≠: ${selectedProduct.qty}`, "warning");
        return;
      }
      
      // ÿ•ÿ∂ÿßŸÅÿ© ŸÑŸÑŸÅÿßÿ™Ÿàÿ±ÿ©
      const existingItem = invoice.find(item => item.id === selectedProduct.id);
      if (existingItem) {
        existingItem.qty += qty;
        existingItem.total = existingItem.qty * selectedProduct.sellPrice;
      } else {
        invoice.push({
          id: selectedProduct.id,
          name: selectedProduct.name,
          price: selectedProduct.sellPrice,
          qty: qty,
          total: selectedProduct.sellPrice * qty
        });
      }
      
      total = invoice.reduce((sum, item) => sum + item.total, 0);
      renderInvoice();
      
      // ÿ•ÿπÿßÿØÿ© ÿ™ÿπŸäŸäŸÜ ÿßŸÑÿ≠ŸÇŸàŸÑ
      document.getElementById("saleSearch").value = "";
      document.getElementById("saleQty").value = "1";
      document.getElementById("saleProductInfo").style.display = "none";
      document.getElementById("searchResults").style.display = "none";
      selectedProduct = null;
    }

    function renderInvoice() {
      const list = document.getElementById("invoiceList");
      list.innerHTML = "";
      
      if (invoice.length === 0) {
        list.innerHTML = '<div class="alert alert-info"><i class="fas fa-info-circle"></i> ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© ŸÅÿßÿ±ÿ∫ÿ©</div>';
        document.getElementById("invoiceTotal").innerText = `ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä: 0 ÿ¨`;
        return;
      }
      
      invoice.forEach((item, index) => {
        list.innerHTML += `
          <div class="sale-item">
            <div>
              <strong>${item.name}</strong><br>
              <small>${item.qty} √ó ${item.price} ÿ¨</small>
            </div>
            <div style="display: flex; align-items: center; gap: 10px;">
              <span>${item.total} ÿ¨</span>
              <button class="btn btn-danger btn-sm" onclick="removeFromInvoice(${index})">
                <i class="fas fa-times"></i>
              </button>
            </div>
          </div>`;
      });
      
      document.getElementById("invoiceTotal").innerText = `ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä: ${total} ÿ¨`;
    }

    // ÿ•ÿ≤ÿßŸÑÿ© ŸÖŸÜ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©
    window.removeFromInvoice = (index) => {
      total -= invoice[index].total;
      invoice.splice(index, 1);
      renderInvoice();
    }

    // ŸÖÿ≥ÿ≠ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©
    window.clearInvoice = () => {
      if (invoice.length === 0) return;
      
      if (confirm("ŸáŸÑ ÿ™ÿ±ŸäÿØ ŸÖÿ≥ÿ≠ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© ÿ®ÿßŸÑŸÉÿßŸÖŸÑÿü")) {
        invoice = [];
        total = 0;
        renderInvoice();
      }
    }

    // ÿ•ÿ™ŸÖÿßŸÖ ÿßŸÑÿ®Ÿäÿπ
    window.completeSale = async () => {
      if (invoice.length === 0) {
        showAlert("‚ö†Ô∏è ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© ŸÅÿßÿ±ÿ∫ÿ©", "warning");
        return;
      }
      
      try {
        // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ
        for (const item of invoice) {
          const product = allProducts.find(p => p.id === item.id);
          if (product) {
            await updateDoc(doc(db, "products", item.id), {
              qty: product.qty - item.qty,
              lowStockAlert: (product.qty - item.qty) <= 5
            });
          }
        }
        
        // ÿ≠ŸÅÿ∏ ÿπŸÖŸÑŸäÿ© ÿßŸÑÿ®Ÿäÿπ
        await addDoc(collection(db, "sales"), {
          items: invoice,
          total: total,
          date: new Date()
        });
        
        showAlert("‚úÖ ÿ™ŸÖ ÿ•ÿ™ŸÖÿßŸÖ ÿßŸÑÿ®Ÿäÿπ ÿ®ŸÜÿ¨ÿßÿ≠", "success");
        invoice = [];
        total = 0;
        renderInvoice();
        loadProducts();
      } catch (error) {
        console.error("Error completing sale: ", error);
        showAlert("‚ùå ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿ•ÿ™ŸÖÿßŸÖ ÿßŸÑÿ®Ÿäÿπ", "danger");
      }
    }

    // ÿ∑ÿ®ÿßÿπÿ© ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©
    window.printInvoice = () => {
      if (invoice.length === 0) {
        showAlert("‚ö†Ô∏è ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© ŸÅÿßÿ±ÿ∫ÿ©", "warning");
        return;
      }
      
      const printWindow = window.open('', '_blank');
      printWindow.document.write(`
        <html dir="rtl">
          <head>
            <title>ŸÅÿßÿ™Ÿàÿ±ÿ© ÿ®Ÿäÿπ</title>
            <style>
              body { font-family: Arial, sans-serif; padding: 20px; }
              .header { text-align: center; margin-bottom: 20px; }
              .item { display: flex; justify-content: space-between; margin-bottom: 10px; }
              .total { font-weight: bold; margin-top: 20px; text-align: center; }
              .footer { margin-top: 30px; text-align: center; font-size: 12px; }
            </style>
          </head>
          <body>
            <div class="header">
              <h2>ŸÅÿßÿ™Ÿàÿ±ÿ© ÿ®Ÿäÿπ</h2>
              <p>${new Date().toLocaleString('ar-EG')}</p>
            </div>
            <div class="items">
              ${invoice.map(item => `
                <div class="item">
                  <span>${item.name} (${item.qty} √ó ${item.price} ÿ¨)</span>
                  <span>${item.total} ÿ¨</span>
                </div>
              `).join('')}
            </div>
            <div class="total">ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä: ${total} ÿ¨</div>
            <div class="footer">ÿ¥ŸÉÿ±ÿßŸã ŸÑÿ≤Ÿäÿßÿ±ÿ™ŸÉŸÖ</div>
          </body>
        </html>
      `);
      printWindow.document.close();
      printWindow.print();
    }

    // ÿßŸÑÿ™ŸÇÿßÿ±Ÿäÿ±
    window.getSalesReport = async () => {
      const startDate = document.getElementById("reportStartDate").value;
      const endDate = document.getElementById("reportEndDate").value;
      
      if (!startDate || !endDate) {
        showAlert("‚ö†Ô∏è ÿßÿÆÿ™ÿ± ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿ®ÿØÿßŸäÿ© ŸàÿßŸÑŸÜŸáÿßŸäÿ©", "warning");
        return;
      }
      
      try {
        const start = new Date(startDate);
        const end = new Date(endDate);
        end.setHours(23, 59, 59, 999);
        
        const salesQuery = query(
          collection(db, "sales"),
          where("date", ">=", start),
          where("date", "<=", end),
          orderBy("date", "desc")
        );
        
        const snapshot = await getDocs(salesQuery);
        const report = document.getElementById("salesReport");
        report.innerHTML = "";
        
        if (snapshot.empty) {
          report.innerHTML = '<div class="alert alert-info"><i class="fas fa-info-circle"></i> ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÖÿ®Ÿäÿπÿßÿ™ ŸÅŸä Ÿáÿ∞ÿß ÿßŸÑÿ™ÿßÿ±ŸäÿÆ</div>';
          return;
        }
        
        let totalSales = 0;
        let salesCount = 0;
        
        snapshot.forEach(doc => {
          const sale = doc.data();
          totalSales += sale.total;
          salesCount++;
          
          report.innerHTML += `
            <div class="sale-item">
              <div>
                <strong>ŸÅÿßÿ™Ÿàÿ±ÿ© #${doc.id.substring(0, 8)}</strong><br>
                <small>${sale.date.toDate().toLocaleString('ar-EG')}</small><br>
                <small>${sale.items.length} ŸÖŸÜÿ™ÿ¨</small>
              </div>
              <div>${sale.total} ÿ¨</div>
            </div>`;
        });
        
        report.innerHTML += `
          <div class="invoice-total">
            <div>ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑŸÖÿ®Ÿäÿπÿßÿ™: ${totalSales} ÿ¨</div>
            <div>ÿπÿØÿØ ÿßŸÑŸÅŸàÿßÿ™Ÿäÿ±: ${salesCount}</div>
            <div>ŸÖÿ™Ÿàÿ≥ÿ∑ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©: ${(totalSales / salesCount).toFixed(2)} ÿ¨</div>
          </div>`;
      } catch (error) {
        console.error("Error getting sales report: ", error);
        showAlert("‚ùå ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿ¨ŸÑÿ® ÿßŸÑÿ™ŸÇÿ±Ÿäÿ±", "danger");
      }
    }

    // ÿ™ŸÇÿ±Ÿäÿ± ÿßŸÑŸäŸàŸÖ
window.getTodayReport = async () => {
  const today = new Date();
  today.setHours(0, 0, 0, 0);
  const tomorrow = new Date(today);
  tomorrow.setDate(tomorrow.getDate() + 1);
  
  try {
    const salesQuery = query(
      collection(db, "sales"),
      where("date", ">=", today),
      where("date", "<", tomorrow),
      orderBy("date", "desc")
    );
    
    const snapshot = await getDocs(salesQuery);
    const report = document.getElementById("salesReport");
    report.innerHTML = "";
    
    if (snapshot.empty) {
      report.innerHTML = '<div class="alert alert-info"><i class="fas fa-info-circle"></i> ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÖÿ®Ÿäÿπÿßÿ™ ÿßŸÑŸäŸàŸÖ</div>';
      return;
    }
    
    let totalSales = 0;
    let salesCount = 0;
    
// üßæ ÿ¥ŸÉŸÑ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© ŸÅŸä ÿ¨ÿØŸàŸÑ
snapshot.forEach(doc => {
  const sale = doc.data();
  totalSales += sale.total;
  salesCount++;
  
  // üõí ÿ¨ÿØŸàŸÑ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿØÿßÿÆŸÑ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©
  let itemsHTML = `
    <table class="items-table">
      <thead>
        <tr>
          <th>ÿßŸÑŸÖŸÜÿ™ÿ¨</th>
          <th>ÿßŸÑŸÉŸÖŸäÿ©</th>
          <th>ÿßŸÑÿ≥ÿπÿ±</th>
          <th>ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä</th>
        </tr>
      </thead>
      <tbody>
  `;
  
  sale.items.forEach(item => {
    itemsHTML += `
      <tr>
        <td>${item.name}</td>
        <td>${item.qty}</td>
        <td>${item.price} ÿ¨</td>
        <td>${item.qty * item.price} ÿ¨</td>
      </tr>
    `;
  });
  
  itemsHTML += `</tbody></table>`;

  // ÿµŸÅ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©
  report.innerHTML += `
    <div class="invoice-box">
      <h3>ŸÅÿßÿ™Ÿàÿ±ÿ© #${doc.id.substring(0, 8)}</h3>
      <small>${sale.date.toDate().toLocaleString('ar-EG')}</small>
      ${itemsHTML}
      <div class="total">ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä: <strong>${sale.total} ÿ¨</strong></div>
    </div>
  `;
});

// ŸÖŸÑÿÆÿµ ÿßŸÑÿ™ŸÇÿ±Ÿäÿ±
report.innerHTML += `
  <div class="invoice-total">
    <div>ÿ•ÿ¨ŸÖÿßŸÑŸä ŸÖÿ®Ÿäÿπÿßÿ™ ÿßŸÑŸäŸàŸÖ: ${totalSales} ÿ¨</div>
    <div>ÿπÿØÿØ ÿßŸÑŸÅŸàÿßÿ™Ÿäÿ±: ${salesCount}</div>
    <div>ŸÖÿ™Ÿàÿ≥ÿ∑ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©: ${(totalSales / salesCount).toFixed(2)} ÿ¨</div>
  </div>`;

  } catch (error) {
    console.error("Error getting today's report: ", error);
    showAlert("‚ùå ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿ¨ŸÑÿ® ÿ™ŸÇÿ±Ÿäÿ± ÿßŸÑŸäŸàŸÖ", "danger");
  }
}


    // ÿ™ŸÇÿ±Ÿäÿ± ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ
    window.getInventoryReport = async () => {
      const inventoryReport = document.getElementById("inventoryReport");
      inventoryReport.innerHTML = "";
      
      if (allProducts.length === 0) {
        inventoryReport.innerHTML = '<div class="alert alert-info"><i class="fas fa-info-circle"></i> ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÖŸÜÿ™ÿ¨ÿßÿ™</div>';
        return;
      }
      
      let totalValue = 0;
      let lowStockCount = 0;
      
      allProducts.forEach(p => {
        const productValue = p.costPrice * p.qty;
        totalValue += productValue;
        
        if (p.qty <= 5) {
          lowStockCount++;
        }
        
        inventoryReport.innerHTML += `
          <div class="sale-item">
            <div>
              <strong>${p.name}</strong><br>
              <small>ÿ®ÿßÿ±ŸÉŸàÿØ: ${p.barcode} | ÿßŸÑŸÅÿ¶ÿ©: ${p.category}</small>
            </div>
            <div>
              <span>${p.qty} Ÿàÿ≠ÿØÿ©</span><br>
              <small>${productValue} ÿ¨</small>
            </div>
          </div>`;
      });
      
      inventoryReport.innerHTML += `
        <div class="invoice-total">
          <div>ÿ•ÿ¨ŸÖÿßŸÑŸä ŸÇŸäŸÖÿ© ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ: ${totalValue} ÿ¨</div>
          <div>ÿπÿØÿØ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ŸÖŸÜÿÆŸÅÿ∂ÿ© ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ: ${lowStockCount}</div>
        </div>`;
    }

    // ÿ•ÿ∏Ÿáÿßÿ± ÿßŸÑÿ™ŸÜÿ®ŸäŸáÿßÿ™
    function showAlert(message, type) {
      const alert = document.createElement("div");
      alert.className = `alert alert-${type}`;
      alert.innerHTML = `<i class="fas fa-${type === 'success' ? 'check-circle' : type === 'warning' ? 'exclamation-triangle' : 'times-circle'}"></i> ${message}`;
      
      document.body.appendChild(alert);
      
      setTimeout(() => {
        alert.remove();
      }, 5000);
    }

    // ÿ™ÿµÿØŸäÿ± ÿßŸÑÿ™ŸÇÿ±Ÿäÿ±
    window.exportReport = () => {
      showAlert("‚è≥ ÿ¨ÿßÿ±Ÿä ÿ™ÿ¨ŸáŸäÿ≤ ÿßŸÑÿ™ŸÇÿ±Ÿäÿ± ŸÑŸÑÿ™ÿµÿØŸäÿ±...", "info");
      setTimeout(() => {
        showAlert("‚úÖ ÿ™ŸÖ ÿ™ÿµÿØŸäÿ± ÿßŸÑÿ™ŸÇÿ±Ÿäÿ± ÿ®ŸÜÿ¨ÿßÿ≠", "success");
      }, 2000);
    }

    // ÿ•ÿ∫ŸÑÿßŸÇ ŸÜÿ™ÿßÿ¶ÿ¨ ÿßŸÑÿ®ÿ≠ÿ´ ÿπŸÜÿØ ÿßŸÑŸÜŸÇÿ± ÿÆÿßÿ±ÿ¨Ÿáÿß
    document.addEventListener('click', function(e) {
      if (!e.target.closest('#saleSearch') && !e.target.closest('#searchResults')) {
        document.getElementById('searchResults').style.display = 'none';
      }
    });
  </script>
</body>
</html>
